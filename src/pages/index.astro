---
import Layout from "@/layouts/Layout.astro";
import Navbar from "@/components/Global/Navbar.astro";
import HeroSwiper from "@/components/Home/HeroSwiper.astro";
import ProductList from "@/components/Home/ProductList.astro";
import FtdProducts from "@/components/Home/FtdProducts.astro";
import WhyChooseUs from "@/components/Home/WhyChooseUs.astro";
import NeedHelp from "@/components/Home/NeedHelp.astro";
import SocialFeed from "@/components/Home/SocialFeed.astro";
import BlogLinks from "@/components/Home/BlogLinks.astro";
import Subnav from "@/components/Home/Subnav.astro";
import NewAbtSec from "@/components/Home/NewAbtSec.astro";
import Cta from "@/components/Home/Cta.astro";
import Footer from "@/components/Global/Footer.astro";

import { sanity } from "@/sanity/lib/sanity";

const home = await sanity.fetch(`
  *[_type == "homePage"][0]{
    heroSlides[]{
      variant,
      eyebrow,
      heading,
      highlight,
      description,
      ctaLabel,
      ctaLink,
      backgroundImage{
        asset->{url}
      }
    },

    productCategories[]{
      name,
      slug,
      image{
        asset->{url}
      }
    },

    ftdProducts{
      heading,
      products[]{
        title,
        subtitle,
        features,
        image{
          asset->{url}
        },
        product->{
          category,
          "slug": slug.current
        }
      }
    },

    socialFeed{
  heading,
  subheading,
  items[] | order(date desc)[0...4]{
    type,
    title,
    description,
    date,
    instagramUrl,

    image{
      asset->{url}
    },

    thumbnail{
      asset->{url}
    },

    video{
      asset->{url}
    }
  }
},


    blogSection{
      heading,
      subheading,
      posts[]->{
        title,
        slug,
        excerpt,
        author,
        publishedAt,
        coverImage{
          asset->{url}
        }
      }
    }
  }
`);

---



<Layout>
  <Navbar />
  <!-- Exclude homepage content from Pagefind; search should only show product detail pages -->
  <main data-pagefind-ignore>
    <HeroSwiper slides={home.heroSlides ?? []} />
    <Subnav />
    <ProductList categories={home.productCategories ?? []} />
    <NewAbtSec />
    <FtdProducts section={home.ftdProducts} />
    <WhyChooseUs />
    <NeedHelp />
    <BlogLinks section={home.blogSection} />
    <SocialFeed section={home.socialFeed} />
    <Cta />
  </main>
  <Footer />
</Layout>
